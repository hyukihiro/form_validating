!function(e){var t={};function s(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)s.d(r,i,function(t){return e[t]}.bind(null,i));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/assets/scripts/",s(s.s=6)}([function(e,t,s){var r=s(1);JSONDATA="https://yubinbango.github.io/yubinbango-data/data",CACHE=[],PREFMAP=[null,"北海道","青森県","岩手県","宮城県","秋田県","山形県","福島県","茨城県","栃木県","群馬県","埼玉県","千葉県","東京都","神奈川県","新潟県","富山県","石川県","福井県","山梨県","長野県","岐阜県","静岡県","愛知県","三重県","滋賀県","京都府","大阪府","兵庫県","奈良県","和歌山県","鳥取県","島根県","岡山県","広島県","山口県","徳島県","香川県","愛媛県","高知県","福岡県","佐賀県","長崎県","熊本県","大分県","宮崎県","鹿児島県","沖縄県"],t.get=function(e,t){var s=e;if(s){for(var r="",a=0;a<s.length;a++){var n=s.charCodeAt(a);n<48||(n>57||(r+=s.charAt(a)))}if(!(r.length<7)){var o=r.substr(0,3),l=CACHE[o];if(l)return i(r,l,t);fetchRemote(r,t)}}};var i=function(e,t,s){var r=t[e],i=e-0+4278190080+"";if(!r&&t[i]&&(r=t[i]),r){var a=r[0];if(a){var n=PREFMAP[a];if(n){var o=r[1];o||(o="");var l=r[2];l||(l="");var c=r[3];c||(c=""),s({prefecture:n,city:o,area:l,street:c})}}}};fetchRemote=function(e,t){var s=e.substr(0,3),a=JSONDATA+"/"+s+".js";r(a,{name:"$yubin"},function(r,a){r||(CACHE[s]=a,i(e,a,t))})}},function(e,t,s){var r=s(2)("jsonp");e.exports=function(e,t,s){"function"==typeof t&&(s=t,t={});t||(t={});var n,o,l=t.prefix||"__jp",c=t.name||l+i++,h=t.param||"callback",u=null!=t.timeout?t.timeout:6e4,d=encodeURIComponent,m=document.getElementsByTagName("script")[0]||document.head;u&&(o=setTimeout(function(){_(),s&&s(new Error("Timeout"))},u));function _(){n.parentNode&&n.parentNode.removeChild(n),window[c]=a,o&&clearTimeout(o)}return window[c]=function(e){r("jsonp got",e),_(),s&&s(null,e)},e=(e+=(~e.indexOf("?")?"&":"?")+h+"="+d(c)).replace("?&","?"),r('jsonp req "%s"',e),(n=document.createElement("script")).src=e,m.parentNode.insertBefore(n,m),function(){window[c]&&_()}};var i=0;function a(){}},function(e,t,s){(function(r){function i(){var e;try{e=t.storage.debug}catch(e){}return!e&&void 0!==r&&"env"in r&&(e=Object({NODE_ENV:"production"}).DEBUG),e}(t=e.exports=s(4)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var s=this.useColors;if(e[0]=(s?"%c":"")+this.namespace+(s?" %c":" ")+e[0]+(s?"%c ":" ")+"+"+t.humanize(this.diff),!s)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var i=0,a=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(a=i))}),e.splice(a,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=i,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(i())}).call(this,s(3))},function(e,t){var s,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(e){if(s===setTimeout)return setTimeout(e,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(e,0);try{return s(e,0)}catch(t){try{return s.call(null,e,0)}catch(t){return s.call(this,e,0)}}}!function(){try{s="function"==typeof setTimeout?setTimeout:a}catch(e){s=a}try{r="function"==typeof clearTimeout?clearTimeout:n}catch(e){r=n}}();var l,c=[],h=!1,u=-1;function d(){h&&l&&(h=!1,l.length?c=l.concat(c):u=-1,c.length&&m())}function m(){if(!h){var e=o(d);h=!0;for(var t=c.length;t;){for(l=c,c=[];++u<t;)l&&l[u].run();u=-1,t=c.length}l=null,h=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===n||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function f(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var s=1;s<arguments.length;s++)t[s-1]=arguments[s];c.push(new _(e,t)),1!==c.length||h||o(m)},_.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=f,i.addListener=f,i.once=f,i.off=f,i.removeListener=f,i.removeAllListeners=f,i.emit=f,i.prependListener=f,i.prependOnceListener=f,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,s){var r;function i(e){function s(){if(s.enabled){var e=s,i=+new Date,a=i-(r||i);e.diff=a,e.prev=r,e.curr=i,r=i;for(var n=new Array(arguments.length),o=0;o<n.length;o++)n[o]=arguments[o];n[0]=t.coerce(n[0]),"string"!=typeof n[0]&&n.unshift("%O");var l=0;n[0]=n[0].replace(/%([a-zA-Z%])/g,function(s,r){if("%%"===s)return s;l++;var i=t.formatters[r];if("function"==typeof i){var a=n[l];s=i.call(e,a),n.splice(l,1),l--}return s}),t.formatArgs.call(e,n),(s.log||t.log||console.log.bind(console)).apply(e,n)}}return s.namespace=e,s.enabled=t.enabled(e),s.useColors=t.useColors(),s.color=function(e){var s,r=0;for(s in e)r=(r<<5)-r+e.charCodeAt(s),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),"function"==typeof t.init&&t.init(s),s}(t=e.exports=i.debug=i.default=i).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var s=("string"==typeof e?e:"").split(/[\s,]+/),r=s.length,i=0;i<r;i++)s[i]&&("-"===(e=s[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var s,r;for(s=0,r=t.skips.length;s<r;s++)if(t.skips[s].test(e))return!1;for(s=0,r=t.names.length;s<r;s++)if(t.names[s].test(e))return!0;return!1},t.humanize=s(5),t.names=[],t.skips=[],t.formatters={}},function(e,t){var s=1e3,r=60*s,i=60*r,a=24*i,n=365.25*a;function o(e,t,s){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+s:Math.ceil(e/t)+" "+s+"s"}e.exports=function(e,t){t=t||{};var l,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return o*n;case"days":case"day":case"d":return o*a;case"hours":case"hour":case"hrs":case"hr":case"h":return o*i;case"minutes":case"minute":case"mins":case"min":case"m":return o*r;case"seconds":case"second":case"secs":case"sec":case"s":return o*s;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?o(l=e,a,"day")||o(l,i,"hour")||o(l,r,"minute")||o(l,s,"second")||l+" ms":function(e){if(e>=a)return Math.round(e/a)+"d";if(e>=i)return Math.round(e/i)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=s)return Math.round(e/s)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,s){"use strict";s.r(t);const r=e=>"string"==typeof e,i=e=>null===e,a=(e="")=>!!r(e)&&/^[ァ-ロワヲンー ｧ-ﾝﾞﾟ|^　|]*$/.test(e),n=(e,t=!0)=>!!r(e)&&(t?/^\d{3}-|−?\d{4}$/.test(e):/^\d{3}\d{4}$/.test(e)),o=e=>!!r(e)&&/^((0(\d{1}[-(]?\d{4}|\d{2}[-(]?\d{3}|\d{3}[-(]?\d{2}|\d{4}[-(]?\d{1}|[5789]0[-(]?\d{4})[-)]?)|\d{1,4}\-?)\d{4}$/.test(e),l=e=>!!r(e)&&/^[0-9]*$/.test(e),c=e=>!!r(e)&&/^[a-zA-Z0-9!$&*.=^`|~#%'+\/?_{}-]+@([a-zA-Z0-9_-]+\.)+[a-zA-Z]{2,4}$/.test(e),h=e=>!!r(e)&&/[0-9０-９]/.test(e);var u=s(0),d=s.n(u);const m={},_=e=>{if(m[e])return m[e];const t=new RegExp(`(^|\\s+)${e}(\\s+|$)`);return m[e]=t,t},f=(e,t)=>{const s=e.className;return!(!s||0===s.length)&&(s===t||_(t).test(s))},p=(e,t)=>{if(i(e))return;const s=e.className;f(e,t)||(e.className+=(s?" ":"")+t)},g=(e,t,s)=>{if(i(e))return;const r=e.className;let a="";(s||f(e,t))&&(a=(e=>e.replace(/^\s+|\s+$/g,""))(r.replace(_(t)," ")),e.className=a)},v=(e,t)=>{(e=>Array.isArray(e))(t)&&t.forEach(t=>g(e,t))},y="is-error-type",E="is-error-required",b="is-error-different";new class{constructor(e){this._container=e,this._state={},this._maxStatus=0,this._timer=-1,this._items=null,this._postcode0=null,this._postcode1=null,this._addresField=null,this._firstName=null,this._lastName=null,this._email0=null,this._email1=null,this._firstNameKana=null,this._lastNameKana=null,this._extraItems=null,this._submitBtn=null,this._famiyContents=null,this._validate=this._validate.bind(this),this._validateEmail=this._validateEmail.bind(this),this._validateKatakana=this._validateKatakana.bind(this),this._validateNumber=this._validateNumber.bind(this),this._validateRequired=this._validateRequired.bind(this),this._onBlur=this._onBlur.bind(this),this._onKeydown=this._onKeydown.bind(this),this._onSelectChange=this._onSelectChange.bind(this),this._classStates={danger:"is-danger",success:"is-success",btnEnable:"is-btn-enable"}}init(){this._addresField=document.querySelector(".js-postcode-target"),this._submitBtn=document.getElementById("js-submit"),this._selectbox=document.getElementById("m_tomo_type_id"),this._famiyContents=document.getElementById("js-family-wrap"),this._extraItems=document.querySelectorAll(".family-member"),this._selectbox.addEventListener("change",this._onSelectChange),this._setItems()}async _setItems(){console.log("_setItems"),this._items=this._container.querySelectorAll(".form-item:not(.is-hide)"),this._maxStatus=this._items.length,this._items.forEach(e=>{let t={};e.hasAttribute("data-json")&&(t=JSON.parse(e.dataset.json)),e.myValidateData=t;const s=t["data-name"],r=e.tagName.toLowerCase();let a=!1;switch(i(t["validate-required"])||"true"!==t["validate-required"]||(a=!0),this._state[s]=!a,"input"!==r&&"textarea"!==r||(e.addEventListener("blur",this._onBlur),e.addEventListener("keydown",this._onKeydown),e.addEventListener("keypress",this._onKeypress)),s){case"name_sei":this._lastName=e;break;case"name_mei":this._firstName=e;break;case"kana_sei":this._lastNameKana=e;break;case"kana_mei":this._firstNameKana=e}})}_onBlur(e){const t=e.target,s=t.myValidateData["data-name"];"zip1"===s?(this._postcode0=t.value,this._checkZipCode()):"zip2"===s&&(this._postcode1=t.value,this._checkZipCode()),this._validate(t)}_onKeydown(e){const t=e.target;-1!==this._timer&&window.clearTimeout(this._timer),this._timer=setTimeout(()=>{this._validate(t)},300)}_onKeypress(e){if(e.which&&13===e.which||e.keyCode&&13===e.keyCode)return e.preventDefault(),!1}async _onSelectChange(e){console.log("_onSelectChange");const t=e.target.value.slice(-1);await this._resetState(),await this._hideExtraElem(),await this._deleteExtraElemValues(),await this._removeClasses(this._extraItems),await this._openExtraElem(t),await this._setItems(),await this._validateAll(),await this._checkAll()}async _resetState(){console.log("_resetState");for(const e in this._state)delete this._state[e]}async _hideExtraElem(){console.log("_hideExtraElem"),this._extraItems.forEach(e=>{const t=e;e.style.display="none",t.querySelectorAll(".form-item").forEach(e=>{e.classList.add("is-hide")})}),console.log("_hideExtraElem done")}async _openExtraElem(e){console.log("_openExtraElem"),this._famiyContents.style.display=e>=2?"block":"none";for(let t=0,s=e-1;t<s;t++){this._extraItems[t].style.display="block";const e=this._extraItems[t].querySelectorAll(".form-item");for(let t=0;t<e.length;t++)e[t].classList.remove("is-hide")}}async _deleteExtraElemValues(){console.log("_deleteExtraElemValues"),this._extraItems.forEach(e=>{e.querySelectorAll(".form-item.is-text").forEach(e=>{e.value=""})})}async _removeClasses(e){console.log("_removeClasses"),e.forEach(e=>{e.querySelectorAll(".form-module").forEach(e=>{v(e,[y,E])})})}async _validateAll(){console.log("_validateAll");const e=document.querySelectorAll(".form-item:not(.is-extra)");for(let t=0;t<e.length;t++){const s=e[t];if(s.value<=0)return;this._validate(s)}}_validate(e){const t=e.myValidateData,s=t["validate-type"],r=JSON.parse(t["validate-required"]),i=t["data-name"];if(s)switch(s){case"katakana":this._validateKatakana(e,i,r);break;case"email":this._validateEmail(e,i,r);break;case"email-confirm":this._validateEmailConfirm(e,i,r);break;case"email-extra":this._validateExtraEmail(e,i,r);break;case"num":this._validateNumber(e,i,r);break;case"tel":this._validateTel(e,i,r);break;default:console.log("in default")}else this._validateRequired(e,i,r)}_validateEmail(e,t,s){const r=e.value,i=e.parentNode.parentNode;this._email0=r,s?r.length<=0?(this._showError(i,E),this._hideError(i,y),this._state[t]=!1):r.length<=0||!c(r)?(this._showError(i,y),this._hideError(i,E),this._state[t]=!1):(v(i,[y,E]),this._state[t]=!0):this._state[t]=!(0!==r.length&&!c(r)),this._checkEqualEmail(e),this._checkAll()}_validateEmailConfirm(e,t,s){const r=e.value,i=e.parentNode.parentNode;this._email1=r,s?r.length<=0?(this._showError(i,E),this._hideError(i,y),this._hideError(i,b),this._state[t]=!1):r.length<=0||!c(r)?(this._showError(i,y),this._hideError(i,E),this._hideError(i,b),this._state[t]=!1):(v(i,[y,E,b]),this._state[t]=!0):this._state[t]=!(0!==r.length&&!c(r)),this._checkEqualEmail(e),this._checkAll()}_validateExtraEmail(e,t,s){const r=e.value,i=e.parentNode.parentNode;s?r.length<=0?(this._showError(i,E),this._hideError(i,y),this._state[t]=!1):r.length<=0||!c(r)?(this._showError(i,y),this._hideError(i,E),this._state[t]=!1):(v(i,[y,E]),this._state[t]=!0):this._state[t]=!(0!==r.length&&!c(r)),this._checkAll()}_validateNumber(e,t,s){const r=e.value,i=e.parentNode.parentNode;s?r.length<=0?(this._showError(i,E),this._hideError(i,y),this._state[t]=!1):r.length<=0||!l(r)?(this._showError(i,y),this._hideError(i,E),this._state[t]=!1):(v(i,[y,E]),this._state[t]=!0):this._state[t]=!!(r.length<=0||h(r)),this._checkAll()}_validateKatakana(e,t,s){const r=e.value,i=e.parentNode.parentNode;s?r<=0?(this._showError(i,E),this._hideError(i,y),this._state[t]=!1):r<=0||!a(r)?(this._showError(i,y),this._hideError(i,E),this._state[t]=!1):(v(i,[y,E]),this._state[t]=!0):this._state[t]=!!(r<=0||a(r)),this._checkAll()}_validateTel(e,t,s){const r=e.value,i=e.parentNode.parentNode;s?r.length<=0?(this._showError(i,E),this._hideError(i,y),this._state[t]=!1):r.length<=0||!o(r)?(this._showError(i,y),this._hideError(i,E),this._state[t]=!1):(v(i,[y,E]),this._state[t]=!0):this._state[t]=!!(r.length<=0||h(r)),this._checkAll()}_validateRequired(e,t,s){const r=e.value,i=e.parentNode.parentNode;s?(r<=0?this._showError(i,E):this._hideError(i,E),this._state[t]=!(e.value>=0)):this._state[t]=!0,this._checkAll()}async _checkAll(){this._maxStatus=Object.keys(this._state).length;let e=0;Object.keys(this._state).forEach(t=>{this._state[t]&&e++}),this._changeSubmitState(!(e!==this._maxStatus))}_checkEqualEmail(e){const t=e.parentNode.parentNode;this._email1&&c(this._email1)&&(this._email0!==this._email1?(this._state.email=!1,this._state.email2=!1,this._showError(t,b),this._hideError(t,y),this._hideError(t,E)):(this._state.email=!0,this._state.email2=!0,v(t,[y,E,b])))}_showError(e,t){f(e,t)||p(e,t)}_hideError(e,t){f(e,t)&&g(e,t)}_changeSubmitState(e){e?p(this._submitBtn,this._classStates.btnEnable):g(this._submitBtn,this._classStates.btnEnable)}_checkZipCode(){const e=`${this._postcode0}${this._postcode1}`;n(e)&&this._fetchAddress(e)}_fetchAddress(e){d.a.get(e,e=>{console.log(e),this._updateAddressByZipCode(e)})}_updateAddressByZipCode(e){const t=`${e.prefecture}${e.city}${e.area}`;this._addresField.value=t,this._validateRequired(this._addresField,"address1",!0)}}(document.getElementById("js-form")).init()}]);